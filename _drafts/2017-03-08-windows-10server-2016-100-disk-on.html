---
layout: post
title: Windows 10/Server 2016 100% Disk on BootCamp and Parallels!
date: '2017-03-08T07:36:00.004-05:00'
author: Michael D. Callaghan
tags: 
modified_time: '2017-03-08T07:36:55.600-05:00'
comments: true
---

I've been wrestling with Windows on my 2014 Mac Mini for more than two years. Soon after I bought the Mac, I made a 200GB BootCamp partition and installed Windows 7. I also bought Parallels 10 Desktop and pointed it at the BootCamp partition. It was great. I had a convenient VM when I needed something quick. I also had BootCamp when I needed native performance. Not long after that, I upgraded it to 8.1. Then sometime later, Windows 10.<br /><br />I don't remember exactly when it happened, but one day I fired up Parallels and my entire system ground to a halt. Shutting down the virtual machine caused everything to go back to normal, so I figured the problem was with Parallels. So I upgraded it. Same problem. I made sure Windows was up-to-date, thinking that maybe the Windows Update service was going nuts. Nothing changed. Whenever Windows was running in Parallels, the Task Manager showed the disk activity pegged at 100%.<br /><br />
<!--more-->
I tried all sorts of online solutions, but none worked. On a whim, I tried it without Parallels. Windows behaved the exact same way when running natively through BootCamp. So it wasn't a Parallels problem, but a Windows problem.<br /><br />Frustrated out of my mind this past week, I decided to blow away the entire partition, and install Windows Server 2016 Standard, to see if a less Desktop-oriented OS would have fewer problems. I downloaded the ISO through my MSDN Subscription and installed it to my BootCamp Partition, opting for a fresh install.<br /><br />As soon as Windows and I logged in, the disk went to 100%. I felt like giving up entirely and buying a cheap laptop and simply not bothering. It was at that point, while looking for something else entirely, I hit on the solution quite by accident.<br /><br />Essentially, it appears to be a driver issue with the virtual hard drive. The solution was to use the device manager to find the device identifier:<br /><br /><img alt="FIX Windows 10 100 Percent Disk Usage Problem" src="https://htse.kapilarya.com/FIX-Windows-10-100-Percent-Disk-Usage-Problem-1.png" /><br /><br />Once in there, simply look for the driver details.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://htse.kapilarya.com/FIX-Windows-10-100-Percent-Disk-Usage-Problem-2.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img alt="FIX Windows 10 100 Percent Disk Usage Problem" border="0" src="https://htse.kapilarya.com/FIX-Windows-10-100-Percent-Disk-Usage-Problem-2.png" /></a></div><br /><img alt="FIX Windows 10 100 Percent Disk Usage Problem" src="https://htse.kapilarya.com/FIX-Windows-10-100-Percent-Disk-Usage-Problem-3.png" /><br /><br />This fix only applies if the driver is storahci.sys. If so, we can go back to the controller properties, and make note of the device instance path, or AHCI Controller Value.<br /><br /><img alt="FIX Windows 10 100 Percent Disk Usage Problem" src="https://htse.kapilarya.com/FIX-Windows-10-100-Percent-Disk-Usage-Problem-4.png" /><br /><br />From there, find that entry in the registry...<br /><pre style="background: rgb(249, 249, 249); border-radius: 4px; border: 1px dashed rgb(227, 227, 227); box-sizing: border-box; font-family: Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; line-height: 1.63em; margin-bottom: 24px; overflow: auto; padding: 15px; word-break: break-all; word-wrap: break-word;"><span style="box-sizing: border-box; font-weight: 700;">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\PCI\<span style="box-sizing: border-box; color: #339966;"><ahci controller="" value=""></ahci></span>\Device Parameters\Interrupt Management\MessageSignaledInterruptProperties</span></pre><div><span style="box-sizing: border-box; font-weight: 700;"><img alt="FIX Windows 10 100 Percent Disk Usage Problem" src="https://htse.kapilarya.com/FIX-Windows-10-100-Percent-Disk-Usage-Problem-5.png" /></span></div><div><span style="box-sizing: border-box; font-weight: 700;"><br /></span></div><div><span style="box-sizing: border-box;">And edit the value of MSISupported from 1 to 0, and reboot.&nbsp;</span></div><div><span style="box-sizing: border-box; font-weight: 700;"><br /></span></div><div><span style="box-sizing: border-box; font-weight: 700;"><img alt="FIX Windows 10 100 Percent Disk Usage Problem" src="https://htse.kapilarya.com/FIX-Windows-10-100-Percent-Disk-Usage-Problem-6.png" /></span></div><div><span style="box-sizing: border-box; font-weight: 700;"><br /></span></div><div>Since following these steps, I haven't had any disk problems. Life is good, at least where Windows on my Mac is concerned. Again, I cannot take credit for figuring this out, but I didn't want to lose it, so I'm reproducing the steps here. Thanks again for the folks at this page who did figure it out. I will be ever grateful.</div><div><br /></div><div>https://www.kapilarya.com/fix-windows-10-100-percent-disk-usage-problem</div><div><br /></div><div><br /></div><div><br /></div>